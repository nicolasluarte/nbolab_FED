weight_data <- weight_path %>%
set_names() %>%
map_dfr(
read_csv,
.id = "file_name"
)
weight_data <- weight_data %>%
select(-file_name) %>%
mutate(
date = lubridate::ymd(date)
) %>%
gather(
.,
"a",
"b"
)
weight_data <- weight_path %>%
set_names() %>%
map_dfr(
read_csv,
.id = "file_name"
)
weight_data <- weight_data %>%
select(-file_name) %>%
mutate(
date = lubridate::ymd(date)
) %>%
gather(
.,
"a",
"b",
-date
)
weight_data <- weight_path %>%
set_names() %>%
map_dfr(
read_csv,
.id = "file_name"
)
weight_data <- weight_data %>%
select(-file_name) %>%
mutate(
date = lubridate::ymd(date)
) %>%
gather(
.,
"animal",
"weight",
-date
)
weight_data <- weight_date %>%
mutate(
protocol = if_else(
date <= "2022-03-28",
"baseline",
if_else(
animal %in% c(321, 322, 324, 327),
"control",
"experimental"
)
)
)
weight_data <- weight_data %>%
mutate(
protocol = if_else(
date <= "2022-03-28",
"baseline",
if_else(
animal %in% c(321, 322, 324, 327),
"control",
"experimental"
)
)
)
weight_data
weight_data_baseline <- weight_data %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight))
View(weight_data_baseline)
weight_data_baseline <- weight_data %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
filter(protocol == "baseline")
merge_weight <- weight_data_baseline %>%
left_join(weight_data)
View(merge_weight)
merge_weight <- weight_data_baseline %>%
left_join(weight_data) %>%
filter(protocol == "baseline")
View(merge_weight)
merge_weight <- weight_data_baseline %>%
left_join(weight_data) %>%
filter(protocol == "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2)
)
merge_weight <- weight_data_baseline %>%
left_join(weight_data) %>%
filter(protocol == "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point()
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point()
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
facet_wrap(~animal)
weight_data_baseline <- weight_data %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
filter(protocol != "baseline")
merge_weight <- weight_data_baseline %>%
left_join(weight_data) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
facet_wrap(~animal)
weight_data_baseline <- weight_data %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
filter(protocol == "baseline")
merge_weight <- weight_data_baseline %>%
left_join(weight_data) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
facet_wrap(~animal)
merge_weight <- weight_data_baseline %>%
left_join(weight_data) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight <- weight_data_baseline %>%
left_join(weight_data)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal"))
weight_data_baseline <- weight_data %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
filter(protocol == "baseline") %>%
select(-protocol)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal"))
weight_data_baseline <- weight_data %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
filter(protocol == "baseline") %>%
select(-protocol)
weight_data_baseline <- weight_data %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
filter(protocol == "baseline") %>%
ungroup() %>%
select(-protocol)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal"))
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
facet_wrap(~animal)
weight_data_baseline <- weight_data %>%
filter(date == "2022-03-28") %>%
select(-protocol)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
weight_data_baseline <- weight_data %>%
filter(date == "2022-03-28") %>%
select(-protocol, -date)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal"))
weight_data_baseline <- weight_data %>%
filter(date == "2022-03-28") %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
filter(protocol == "baseline") %>%
ungroup() %>%
select(-protocol)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
facet_wrap(~animal)
weight_data_baseline <- weight_data %>%
filter(date == "2022-03-18") %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
filter(protocol == "baseline") %>%
ungroup() %>%
select(-protocol)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
facet_wrap(~animal)
weight_data_baseline <- weight_data %>%
filter(date == "2022-03-28") %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
filter(protocol == "baseline") %>%
ungroup() %>%
select(-protocol)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
facet_wrap(~animal)
weight_data_baseline <- weight_data %>%
filter(date == "2022-04-04") %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
ungroup() %>%
select(-protocol)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
facet_wrap(~animal)
weight_data_baseline <- weight_data %>%
filter(date == "2022-03-30") %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
ungroup() %>%
select(-protocol)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
merge_weight %>%
ggplot(
aes(
date,
perc_diff,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
facet_wrap(~animal)
merge_weight %>%
ggplot(
aes(
date,
weight,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
geom_line(
inherit.aes = FALSE,
aes(
date,
baseline_weight
),
color = "gray50"
)
merge_weight %>%
ggplot(
aes(
date,
weight,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
geom_line(
inherit.aes = FALSE,
aes(
date,
baseline_weight
),
color = "gray50"
) +
facet_wrap(~animal)
weight_data_baseline <- weight_data %>%
filter(date == "2022-03-18") %>%
group_by(protocol, animal) %>%
summarise(baseline_weight = mean(weight)) %>%
ungroup() %>%
select(-protocol)
merge_weight <- weight_data_baseline %>%
left_join(weight_data, by = c("animal")) %>%
filter(protocol != "baseline") %>%
mutate(
perc_diff = (weight - baseline_weight) / ((weight + baseline_weight) / 2) * 100
)
View(merge_weight)
merge_weight %>%
ggplot(
aes(
date,
weight,
color = protocol
)
) +
geom_line(color = "gray70") +
geom_point() +
geom_line(
inherit.aes = FALSE,
aes(
date,
baseline_weight
),
color = "gray50"
) +
facet_wrap(~animal)
merged_data %>%
filter(date >= "2022-03-30") +
ggplot(aes(
date,
pellets_consumed,
color = protocol
)) +
geom_line(color = "gray70") +
geom_point() +
geom_line(
inherit.aes = FALSE,
aes(
date,
baseline_intake
),
color = "gray50"
) +
facet_wrap(~animal) +
xlab("Date") +
ylab("Pellets consumed per day") +
theme(text = element_text(size = 20)) +
labs(color = "Control/Experimental") +
scale_color_manual(values=c("#999999", "#E69F00")) +
theme_bw() +
theme(strip.background = element_rect(colour="black",
fill="white"))
merge_weight %>%
group_by(protocol) %>%
summarise(m = mean(perc_diff))
merge_weight %>%
filter(date >= "2022-04-13") %>%
group_by(protocol) %>%
summarise(m = mean(perc_diff))
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(
tidyverse,
cowplot,
lme4,
lmerTest,
ggrepel
)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(
tidyverse,
cowplot,
lme4,
lmerTest,
ggrepel
)
